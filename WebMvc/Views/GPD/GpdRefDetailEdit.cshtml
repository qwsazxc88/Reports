@model Reports.Presenters.UI.ViewModel.GpdRefDetailEditModel
@{
    Layout = "~/Views/Shared/_LayoutGPD.cshtml";
    ViewBag.Title = "Редактирование справочника реквизитов";
}

@using (Html.BeginForm())
{
    <table style="width:100%">
        <tr>
            <td colspan="2">
                <h5 >
                    <label id="errorMessage" style="color:red">@Model.errorMessage</label>
                    @Html.ValidationMessageFor(model => model.errorMessage)
                </h5>
                <div class="doc-wrap">
                    <table style="width:100%">
                        <tr>
                            <td colspan="2">
                                <b>Создание/редактирование записи в справочнике реквизитов</b>
                                <input type="hidden" id="Id" name="Id" value="@Model.Id" />
                                <input type="hidden" id="CreatorID" name="CreatorID" value="@Model.CreatorID" />
                                @*
                                <input type="hidden" id="DTID" name="DTID" value="@Model.DTID" />
                                <input type="hidden" id="Name" name="Name" value="@Model.Name" />
                                <input type="hidden" id="Code" name="Code" value="@Model.Code" />
                                <input type="hidden" id="INN" name="INN" value="@Model.INN" />
                                <input type="hidden" id="KPP" name="KPP" value="@Model.KPP" />
                                <input type="hidden" id="Account" name="Account" value="@Model.Account" />
                                <input type="hidden" id="BankName" name="BankName" value="@Model.BankName" />
                                <input type="hidden" id="BankBIK" name="BankBIK" value="@Model.BankBIK" />
                                <input type="hidden" id="CorrAccount" name="CorrAccount" value="@Model.CorrAccount" />
                                *@
                                <input type="hidden" id="StatusID" name="StatusID" value="@Model.StatusID" />
                            </td>
                        </tr>
                        <tr>
                            <td style="width:220px">
                                @Html.LabelFor(m => m.DTID):
                            </td>
                            <td>
                                @Html.DropDownListFor(model => model.DTID, new SelectList(Model.DetailTypes, "ID", "Name"), Model.StatusID == 4 ? null : (object)new { disabled = "disabled" }) 
                                @Html.ValidationMessageFor(model => model.DTID)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.Name):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.Name, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.Name)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.Code):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.Code, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.Code)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.INN):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.INN, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.INN)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.KPP):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.KPP, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.KPP)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.Account):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.Account, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.Account)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.BankName):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.BankName, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.BankName)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.BankBIK):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.BankBIK, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.BankBIK)
                            </td>
                        </tr>
                        <tr>
                            <td>
                                @Html.LabelFor(model => model.CorrAccount):
                            </td>
                            <td>
                                @Html.TextBoxFor(model => model.CorrAccount, Model.StatusID == 4 ? null : (object)new { disabled = "disabled" })
                                @Html.ValidationMessageFor(model => model.CorrAccount)
                            </td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
        
        <tr>
            <td colspan="2">
                @if (@Model.Permissions[0].IsWrite)
                {
                    if (@Model.StatusID == 4)
                    {
                        <input type="submit" value="Записать" title="Сохранить введенные данные в базе данных" onclick="EditModeOff();"/>
                        if (@Model.Id != 0)
                        {
                            <input type="submit" value="Отменить" title="Перейти в режим просмотра текущего реквизита" onclick="CancelEditMode();"/>
                        }
                    }
                    if (@Model.StatusID == 2)
                    {
                        <input type="submit" value="Редактировать" title="Перейти в режим редактирования текущего реквизита" onclick="EditModeOn();"/>
                    }
                }
            </td>
        </tr>
    </table>

}

<script type="text/javascript">
    $(document).ready(function () {
        //$("#BeginDate").datepicker();
        //$("#EndDate").datepicker();
        //$(".hasDatepicker").width("75px");
        //setSortFields();
        setActiveMenuItem("moGpdRefDetail");
    });

    function EditModeOn() {
        $("#StatusID").val('4');
        return true;
    }
    function EditModeOff() {
        $("#StatusID").val('2');
        return true;
    }
    function CancelEditMode() {
        $("#StatusID").val('3');
        return true;
    }
 </script>   

